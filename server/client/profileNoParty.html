Loggedd innn!
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="socket.io/socket.io.js"></script>
    <script type="text/javascript">
      var socket = io("http://192.168.1.114:4000");
      let currId;
      socket.on("welcome", function (msg) {
        document.getElementById("response").innerHTML = msg + "<br/>";
        currId = msg;
      });
      socket.emit("login", "ok");

      socket.on("newFriend", function (msg) {
        var retrieveP = msg.party;
        var retrieveE = "newFriend";
        document.getElementById("newFriend").innerHTML =
          document.getElementById("newFriend").innerHTML +
          "Nuova richiesta di amicizia da " +
          msg.source +
          "<br/>";
      });

      //Se non mi trovo sulla pagina relativa al party visualizzo solo la notifica
      socket.on("newComment", function (msg) {
        document.getElementById("newComment").innerHTML =
          document.getElementById("newComment").innerHTML +
          "Nuovo commento da " +
          msg.source +
          " in party " +
          msg.party +
          "<br/>";
      });

      //Se mi trovo sulla pagina relativa al party visualizzo l'Oggetto Comment
      socket.on("newCommentOnP", function (msg) {
        document.getElementById("newComment").innerHTML =
          document.getElementById("newComment").innerHTML +
          "Nuovo commento da " +
          msg.source +
          " in party " +
          msg.party +
          "<br/>";
      });

      socket.on("newInvitation", function (msg) {
        retrieveP = msg.party;
        retrieveE = "newInvitation";
        document.getElementById("newInvitation").innerHTML =
          document.getElementById("newInvitation").innerHTML +
          "Sei stato invitato da " +
          msg.source +
          " al party " +
          msg.party +
          "<br/>";

        document.getElementById("pending").innerHTML =
          document.getElementById("pending").innerHTML +
          "Sei stato invitato da " +
          msg.source +
          " al party " +
          msg.party +
          "<br/>";
      });
      /*
    socket.on("joined", function (msg) {
      document.getElementById("newInvitation").innerHTML =
        document.getElementById("newInvitation").innerHTML +
        msg.source +
        " si e' appena aggiunto al party " +
        msg.party +
        "<br/>";
    });*/

      function send() {
        let userId = document.getElementById("userId").value || 0;
        let event = document.getElementById("type").value;
        let partyId = document.getElementById("party").value || 0;
        let comm = document.getElementById("comment").value;

        const d = {
          source: currId,
          destination: userId,
          event: event,
          party: partyId,
          commentTxt: comm, //questo testo serve per aggiungerlo nel db, ma poi sulla pagina in tempo reale verra' reinderizzato l'oggetto.
          state: true,
        };
        socket.emit(event, d);
      }

      function ok() {
        /*let userId = document.getElementById("userId").value;
      let event = document.getElementById("type").value;
      let partyId = document.getElementById("party").value || 0;
      let comm = document.getElementById("comment").value;
  */
        const d = {
          source: currId,
          destination: 0,
          event: "joined",
          party: 1,
          commentTxt: "", //questo testo serve per aggiungerlo nel db, ma poi sulla pagina in tempo reale verra' reinderizzato l'oggetto.
          state: false, // o false???
        };
        socket.emit("joined", d);
      }

      const root = document.getElementById("friend-conteinter");
      /*const aggiungiAmico = function (e) {
      fetch("/user/accept", {
        method: "POST", // *GET, POST, PUT, DELETE, etc.
        credentials: "include", // include, *same-origin, omit
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          friendId: e.target.parentElement.id,
        }),
      }).then((response) => {
        console.log(response);
        getFriend();
      });
    };
    /*
    const buildFriendList = function (data, rootEl) {
      data.forEach((element) => {
        let div = document.createElement("div");
        div.id = element.id;
        let accettaBtn;
        if (element.pending) {
          accettaBtn = document.createElement("button");
          accettaBtn.addEventListener("click", aggiungiAmico);
          accettaBtn.innerText = "Accetta " + element.firstName;
        }
        div.innerHTML = `
                <h4>${element.firstName} ${element.lastName}</h4>
                 <p>${element.email}</p>`;
        rootEl.appendChild(div);
        div.appendChild(accettaBtn);
      });
    };
    const getFriend = function () {
      fetch("user/friend", {
        method: "GET",
        credentials: "include",
      })
        .then((response) => response.json())
        .then((json) => {
          console.log(json);
          buildFriendList(json, root);
        })
        .catch((err) => {
          console.log(err);
        });
    };
    getFriend();
    */
    </script>
  </head>
  <body>
    </form>

    <hr />
    <label for="send">Invia una notifica</label>
    <br />
    <input type="text" id="userId" placeholder="user id..." value="2" />
    <input
      type="text"
      id="type"
      placeholder="newFriend/newComment/newInvitation"
      value="newInvitation"
    />
    <input type="text" id="party" placeholder="party id..." value="1" />
    <textarea
      id="comment"
      placeholder="Write you comment here..."
      rows="4"
      cols="50"
    ></textarea>
    <input type="button" id="send" value="Invia" onclick="send();" />
    <hr />
    <br />
    <h2>Notifiche:</h2>
    <hr />
    <label for="response">Risposta del server:</label>
    <br />
    <div id="response"></div>
    <hr />
    <label for="newFriend">Notifiche di newFriend:</label>
    <br />
    <div id="newFriend"></div>
    <hr />
    <label for="newComment">Notifiche di newComment:</label>
    <br />
    <div id="newComment"></div>
    <hr />
    <label for="newInvitation">Notifiche di newInvitation:</label>
    <br />
    <div id="newInvitation"></div>
    <hr />
    <label for="pending">Notifiche da accettare:</label>
    <br />
    <input type="button" id="accetta" value="Accetta" onclick="ok();" />
    <input type="button" id="deny" value="Rifiuta" />
    <br />
    <div id="pending"></div>
  </body>
</html>
